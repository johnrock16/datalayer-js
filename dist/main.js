function d(p,c){let y=p.split(/\.|\[|\]/).filter(Boolean),r=c;for(let t of y)if(r!=null){let u=Number(t);!isNaN(u)&&Array.isArray(r)?r=r[u]:r=r[t]}else return;return r}function A(p,c,y){let r=p.split(/\.|\[|\]/).filter(Boolean),t=y;for(let s=0;s<r.length-1;s++){let i=r[s],l=Number(i);!isNaN(l)&&Array.isArray(t)?(t[l]===void 0&&(t[l]={}),t=t[l]):(t[i]===void 0&&(t[i]={}),t=t[i])}let u=r[r.length-1],f=Number(u);!isNaN(f)&&Array.isArray(t)?t[f]=c:t[u]=c}function D(p,c,y){let r=c,t=r.eventDetails,u=p,f=y,s={event:u,previousFunctionReturn:null},i=(e,n,o=!0)=>{s[e]=n,o&&(s.previousFunctionReturn={name:e,state:n})},l=(e,n,o)=>{if(typeof e=="string"){if(e.indexOf("w__")===0)return d(e.split("w__")[1],f);if(e.indexOf("e__")===0)return d(e.split("e__")[1],n.event);if(e.indexOf("c__")===0){let a=e.split("__");return o!==null&&(a[1]=a[1].replace("[]",`[${o}]`)),d(a[1],n)}}return e},g=(e,n,o=null)=>{if(Array.isArray(e))return e.map((a,m)=>g(a,n,m));if(typeof e=="object"&&e!==null){let a={};return Object.keys(e).forEach(m=>{a[m]=g(e[m],n,o)}),a}return l(e,n,o)},h=(e=!0)=>{let n={},o=s.data?s.data:t;return Object.keys(o).forEach(a=>{n[a]=g(o[a],s)}),e&&i("getData",n),n};return{state:s,template:r,eventDetails:t,window:f,setState:i,pushData:()=>{let e=h(!1);f.dataLayer.push(e)},getData:h,createArrayTemplate:()=>{let[e]=r?.parameters.createArrayTemplate[0],n=d(e,t);A(e,s[s.previousFunctionReturn.name].map(()=>n[0]),t),r?.parameters.createArrayTemplate.shift()}}}function x(p,c,y,r){let t=D(p,c,y);return r.reduce((f,s)=>{let i=s(t);return{...f,...i}},{...t})}export{x as createDataLayerManager,D as dataLayerFunctions};
